{"version":3,"sources":["PreviewPane.js","Sliders/components.js","Sliders/BarChart.js","Sliders/RangeSlider.js","Sliders/Sliders.js","SliderPane.js","QueryFilter.js","FilterPane.js","InfoFields.js","InfoPane.js","ViewPane.js","MappingsPane.js","Export.js","Projection.js","Layout.js","Data.js","App.js","serviceWorker.js","index.js"],"names":["PreviewPane","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","state","dimensions","imgURL","previewImage","timeoutId","_createClass","key","value","this","setPreviewPaneCanvas","side_canvas","prevProps","_this2","hover_index","setState","clearTimeout","setTimeout","_this3","previewPane_image_size","_jsxs","children","style","position","width","height","textAlign","_jsx","display","verticalAlign","setPreviewImage","ref","Component","React","memo","thumbHeight","MuiRail","withStyles","theme","rail","backgroundColor","palette","grey","pointerEvents","railHotspot","top","cursor","_ref","classes","getRailProps","Fragment","_objectSpread","className","MuiHandle","root","secondary","main","marginLeft","marginTop","border","borderRadius","whiteSpace","zIndex","_ref2","_ref2$domain","_slicedToArray","domain","min","max","_ref2$handle","handle","id","percent","getHandleProps","role","left","concat","MuiTrack","track","trackHotspot","_ref3","source","target","getTrackProps","MuiTickComponent","_ref4","tick","count","format","Typography","label","variant","defaultProps","d","BarChart","_React$Component","isHovering","barSelected","onLeave","bind","_assertThisInitialized","normalize","data","i","settings","currentProjection","push","metadata","sliderID","buckets","bucketsFinder","stepSize","targetBucket","Math","abs","length","bucketCount","parseFloat","toFixed","bucketList","Object","values","ratio","apply","round","barDataValues","chartElement","barID","index","arr","Float32Array","fill","prevArr","barData","forEach","element","calculateProjection","_this$props","color","selected","defaults","animation","markerData","Array","barDataSoll","histogram","barDataIst","calculateHistogram","barDataCalc","labels","map","val","datasets","type","barThickness","normalized","order","hoverBackgroundColor","options","responsive","interaction","mode","intersect","events","onClick","onHover","event","bgColor","hoverEffect","native","plugins","legend","tooltip","enabled","scales","x","stacked","yAxes","beginAtZero","Bar","onMouseLeave","RangeSlider","datafilter","range","update","inputValues","typeNumber","step","isToggleOn","changeSlider","currentValues","handleClick","e","prevState","stopPropagation","onChangeSlider","title","_this$state","Grid","container","item","xs","Slider","rootStyle","onUpdate","onChange","Rail","Handles","handles","Tracks","right","tracks","alignItems","justifyContent","marginRight","TextField","fullWidth","size","margin","inputProps","padding","evt","newState","Tooltip","info","Sliders","slidersAr","sliders","refSliders","filterData","filtered","createRef","filterVals","componentName","console","log","filteredArr","list","idx","reduce","curr","SliderList","slider","SliderPane","sliderReset","filterImageAr","CustomAutoComplete","_GridDataAutoComplete","arguments","parsedCategory","_get","_getPrototypeOf","prototype","GridDataAutoCompleteHandler","CustomResultProcessing","_SimpleResultProcessi","_super2","row","fieldOrLabel","operator","field","tryToGetFieldCategory","toLowerCase","indexOf","_","startsWith","SimpleResultProcessing","Filterbox","_super3","exportMetadata","filteredMetadata","obj","filterDataToExportCSV","document","getElementsByClassName","click","parseOK","query2","applyFilter","resetFilter","search","customAutoComplete","newData","process","query","self","pick","fontWeight","fontSize","expressions","ReactFilterBox","autoCompleteHandler","customRenderCompletionItem","onParseOk","onParseError","editorConfig","lineWrapping","ButtonGroup","Button","FilterPane","spacing","allFilter","InfoFields","infos","linkStyle","InfoList","uuid","substring","href","rel","wrap","Title","InfoPane","ViewPane","handleChange","checked","handleChangeGrey","filterGrey","clusters","handleChangeCluster","option","Box","defaultValue","scaleMin","handleChangeScale","scaleMax","handleChangeZoom","MappingsPane","handleSelectAlgorithm","handleSelectDataset","v","selectAlgorithm","selectDataset","algorithm_options","algorithm_choice","dataset_options","selectedDataset","datasetInfo","Export","makePNG","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_context","prev","next","canvasToImage","getElementById","stop","_Fragment","marginBottom","CSVLink","filename","Projection","handleResize","camera","aspect","updateProjectionMatrix","renderer","setSize","current_scale","getScaleFromZ","z","d3_x","d3_y","y","resize_transform","d3","translate","scale","view","mount","d3_zoom","transform","updateProjection","ar","filterAr","ranges","ar_sliced","sprite_number","start","sprite_size","end","slice","c","points","scene","geometry","attributes","filteredActive","THREE","needsUpdate","updatePass2Shader","num","material","uniforms","greyTransparency","imageTransparency","updateClusterColors","clusterSelected","numVertices","clusterColors","total","clustersAr_sliced","l","clusterId","cluster","clusterActive","loadTiles","tilesLoaded","init","pointsAr","addPoints","setupCamera","animate","getZFromScale","changeEmbeddings","sprite_side","tile_locations","_toConsumableArray","n","sprite_dir","datasetIMG","src","img","createElement","new_choice","embedding_chunks","mappings","_loop","echunk","array","tween","TWEEN","to","easing","Linear","None","input","clamp","scaleProj","rvFOV","degToRad","fov","tan","camera_z_position","fov_height","d3_transform","k","set","new_size","zoomScaler","point_group","camera_z_start","embeddings_data","vFOV","min_x","max_x","ys","min_y","max_y","max_x_from_center","m","max_y_from_center","far","scaleExtent","on","zoomHandler","initial_scale","initial_transform","_this4","_this$props2","loader","textures","t","load","w","flipY","magFilter","vertices","embedding","vert","positionAr","offsetAr","clusterAr","addAttribute","texture_subsize","sprite_image_size","sprite_actual_size","floor","clusterList","clusterTypeSelected","includes","texture","repeat","vertexShader","fragmentShader","transparent","point_cloud","userData","sprite_index","add","hover_container","point","frustumCulled","visible","digit_index","full_index","_this$props3","offsets","copyVector3sArray","offset","highlight_container","highlights","remove","mouse_position","_this$props4","previewPane_ctx","mouse_vector","mouseX","mouseY","mouseToThree","raycaster","setFromCamera","params","Points","threshold","intersects","intersectObjects","sorted_intersects","sortIntersectsByDistanceToRay","object","undefined","setHoverIndex","highlightPoint","clearRect","fillRect","fillStyle","drawImage","error","_this5","domElement","_d3$mouse","node","_d3$mouse2","checkIntersects","clickOnImage","_this$props5","preserveDrawingBuffer","alpha","setClearColor","autoClear","appendChild","addBlankHighlightPoints","handleMouse","requestAnimationFrame","clear","parseInt","greyRenderTypeSelected","render","_this$props6","removeChild","_this6","_this$props7","tileProgress","allTiles","CircularProgress","overflow","Layout","newArr","A","B","currentFilter","currentSearch","refProjection","current","toggleControl","collapsedControl","toggleObject","collapsedObject","ww","wh","previewPane_height","controlPane_height","filterPane_height","setDefaults","algorithm_name","window","addEventListener","addToUrl","p","changeDataset","innerWidth","innerHeight","previewPane_mount","offsetHeight","imageSmoothingEnabled","canvas","ctx","getContext","url_prefix","alt","removeEventListener","url","link_URL","open","err","main_style","background","general_style","lineHeight","displayNumb","maxHeight","controlMenu_mount","ProSidebar","collapsed","Menu","iconShape","MenuItem","FaAngleDoubleLeft","FaAngleDoubleRight","SubMenu","defaultOpen","icon","FaDatabase","grem","font_size","FaSlidersH","FaSearch","FaCloudDownloadAlt","FaRegImage","FaInfo","FaEye","FaQuestion","datasetDir","initPath","Data","dataset_dirs","defaultDataset","embeddings","queryString","location","urlParams","URLSearchParams","get","loadInit","path","loadSettings","loadBarData","loadMetadata","ID","name","fetch","file","then","response","json","scaled_embeddings","paramName","navigate","toString","directory","choice","newDataset","loadConfig","default","foundInitDataset","floatColorConvertedArr","rgb","prepareMappings","loadDataset","withRouter","useParams","useNavigate","App","BrowserRouter","Routes","Route","exact","WithRouter","Boolean","hostname","match","ReactDOM","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.b28e90d8.chunk.js","sourcesContent":["import React, { Component } from 'react'\n\nclass PreviewPane extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dimensions: {},\n      imgURL: null,\n      previewImage: false,\n      timeoutId: null\n    };\n    // this.onImgLoad = this.onImgLoad.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.setPreviewPaneCanvas(this.side_canvas);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.hover_index !== prevProps.hover_index) {\n      this.setState({ previewImage: false });\n      clearTimeout(this.state.timeoutId);\n      const timeoutId = setTimeout(() => {\n        this.setState({ previewImage: true });\n      }, 100);\n      this.setState({ timeoutId });\n    }\n  }\n\n  render() {\n    let {\n      previewPane_image_size,\n    } = this.props;\n    // const {width, height} = this.state.dimensions;\n    // var imgWidth = \"auto\";\n    // var imgHeight = \"100%\";\n    // if (width >= height) {\n    //   imgWidth = \"100%\";\n    //   imgHeight = \"auto\"\n    // };\n\n    return (\n      <div>\n      <div style={{position: \"absolute\", width: previewPane_image_size, height: previewPane_image_size, textAlign: \"center\"}}>\n        <span style={{display: \"inline-block\", height: \"100%\", verticalAlign: \"middle\"}}/>\n\n      {this.state.previewImage === true ? this.props.setPreviewImage() : null}\n      \n      </div>\n        <canvas \n          ref={side_canvas => {\n            this.side_canvas = side_canvas\n          }}\n          width={previewPane_image_size}\n          height={previewPane_image_size}\n        />\n      </div>\n    )\n  }\n}\nexport default React.memo(PreviewPane)\n","import React, { Fragment } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { withStyles } from \"@material-ui/core/styles\";\n\n// Based on Material Design spec:\n// Styles by https://github.com/RafeSacks\n// https://material.io/design/components/sliders.html#spec\nconst trackHeight = 2;\nconst thumbHeight = 12;\n\n// *******************************************************\n// RAIL COMPONENT\n// *******************************************************\n\nconst muiRailStyle = theme => ({\n  rail: {\n    backgroundColor: theme.palette.grey[400],\n    width: \"100%\",\n    height: trackHeight,\n    position: \"absolute\",\n    pointerEvents: \"none\"\n  },\n  railHotspot: {\n    // backgroundColor: \"green\", // for debugging\n    width: \"100%\",\n    height: thumbHeight * 2, // Invisible hotspot same size as thumb\n    top: thumbHeight * -1,\n    position: \"absolute\",\n    cursor: \"pointer\"\n  }\n});\n\nfunction MuiRailComponent({ classes, getRailProps }) {\n  return (\n    <Fragment>\n      <div className={classes.railHotspot} {...getRailProps()} />\n      <div className={classes.rail} />\n    </Fragment>\n  );\n}\n\nMuiRailComponent.propTypes = {\n  classes: PropTypes.object.isRequired,\n  getRailProps: PropTypes.func.isRequired\n};\n\nexport const MuiRail = withStyles(muiRailStyle)(MuiRailComponent);\n\n// *******************************************************\n// HANDLE COMPONENT\n// *******************************************************\n\nconst muiHandleStyle = theme => ({\n  root: {\n    backgroundColor: theme.palette.secondary.main,\n    marginLeft: thumbHeight * -0.5,\n    marginTop: thumbHeight * -0.5,\n    width: thumbHeight,\n    height: thumbHeight,\n    border: 0,\n    borderRadius: \"50%\", // circle\n    // boxShadow: \"1px 1px 1px 1px rgba(0, 0, 0, 0.2)\",\n    whiteSpace: \"nowrap\", // for child display inline-block to work\n    position: \"absolute\",\n    zIndex: 2,\n    cursor: \"pointer\"\n  }\n});\n\nfunction MuiHandleComponent({\n  domain: [min, max],\n  handle: { id, value, percent },\n  classes,\n  getHandleProps\n}) {\n  return (\n    <div\n      role=\"slider\"\n      aria-valuemin={min}\n      aria-valuemax={max}\n      aria-valuenow={value}\n      className={classes.root}\n      style={{ left: `${percent}%` }}\n      {...getHandleProps(id)}\n    />\n  );\n}\n\nMuiHandleComponent.propTypes = {\n  domain: PropTypes.array.isRequired,\n  handle: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  classes: PropTypes.object.isRequired,\n  getHandleProps: PropTypes.func.isRequired\n};\n\nexport const MuiHandle = withStyles(muiHandleStyle)(MuiHandleComponent);\n\n// *******************************************************\n// TRACK COMPONENT\n// *******************************************************\n\nconst muiTrackStyle = theme => ({\n  track: {\n    backgroundColor: theme.palette.secondary.main,\n    height: trackHeight,\n    position: \"absolute\",\n    zIndex: 1,\n    pointerEvents: \"none\"\n  },\n  trackHotspot: {\n    // backgroundColor: \"grey\", // for debugging\n    height: thumbHeight, // Invisible hotspot same size as thumb\n    top: thumbHeight * -0.5,\n    position: \"absolute\",\n    cursor: \"pointer\"\n  }\n});\n\nfunction MuiTrackComponent({ classes, source, target, getTrackProps }) {\n  const left = `${source.percent}%`;\n  const width = `${target.percent - source.percent}%`;\n\n  return (\n    <Fragment>\n      <div className={classes.track} style={{ left, width }} />\n      <div\n        className={classes.trackHotspot}\n        style={{ left, width }}\n        {...getTrackProps()}\n      />\n    </Fragment>\n  );\n}\n\nMuiTrackComponent.propTypes = {\n  source: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  target: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  classes: PropTypes.object.isRequired,\n  getTrackProps: PropTypes.func.isRequired\n};\n\nexport const MuiTrack = withStyles(muiTrackStyle)(MuiTrackComponent);\n\n// *******************************************************\n// TICK COMPONENT\n// *******************************************************\n\nconst muiTickStyle = theme => ({\n  tick: {\n    position: \"absolute\",\n    marginTop: 14,\n    width: 1,\n    height: 5,\n    backgroundColor: theme.palette.grey[400]\n  },\n  label: {\n    position: \"absolute\",\n    marginTop: 22,\n    textAlign: \"center\"\n  }\n});\n\nexport function MuiTickComponent({ classes, tick, count, format }) {\n  return (\n    <div>\n      <div className={classes.tick} style={{ left: `${tick.percent}%` }} />\n      <Typography\n        className={classes.label}\n        variant=\"caption\"\n        style={{\n          marginLeft: `${-(100 / count) / 2}%`,\n          width: `${100 / count}%`,\n          left: `${tick.percent}%`\n        }}\n      >\n        {format(tick.value)}\n      </Typography>\n    </div>\n  );\n}\n\nMuiTickComponent.propTypes = {\n  tick: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  classes: PropTypes.object.isRequired,\n  count: PropTypes.number.isRequired,\n  format: PropTypes.func.isRequired\n};\n\nMuiTickComponent.defaultProps = {\n  format: d => d\n};\n\nexport const MuiTick = withStyles(muiTickStyle)(MuiTickComponent);\n","import React from \"react\";\nimport { Bar, defaults } from \"react-chartjs-2\";\n\nclass BarChart extends React.Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      // bgColor: this.props.color,\n      isHovering: false,\n      barSelected: null,\n    }\n    this.onLeave = this.onLeave.bind(this)\n    // this.showHideUpdate = this.showHideUpdate.bind(this);\n  }\n  \n\n  calculateHistogram(domain,normalize){\n    // Calculate frequency of data (adapted for float numbers)\n    let data = []\n    for(let i=0;i<this.props.settings[\"total\"];i++){\n      if(this.props.currentProjection[i]===0){\n        data.push(this.props.metadata[i][this.props.sliderID])\n      }\n    }\n    var buckets = {};\n    this.bucketsFinder = {};\n    const bucketCount = 50;\n    var stepSize;\n    if(domain[0] < 0){stepSize = (Math.abs(domain[0]) + Math.abs(domain[1])) / bucketCount}\n    else{stepSize = Math.abs((Math.abs(domain[0]) - Math.abs(domain[1])) / bucketCount)}\n    // Console.log(\"stepSize\", stepSize);\n    for (let i = 0; i < bucketCount; i++) {\n      buckets[i] = 0;\n    }\n    var targetBucket;\n      for (var i = 0; i < data.length; i++) {\n        if (data[i] === domain[1]){targetBucket = bucketCount-1}\n        else {\n          // console.log(data[i])\n          targetBucket = ((data[i] - domain[0]) / stepSize) | 0\n        }\n        buckets[targetBucket] +=1;\n        // if (typeNumber === \"int\")\n        // this.bucketsFinder[parseInt(data[i])] = targetBucket;\n        // else\n        this.bucketsFinder[parseFloat(data[i]).toFixed(1)] = targetBucket;\n      }\n    var bucketList = Object.values(buckets)\n    if (normalize === true){\n      // Normalize data\n      var ratio = Math.max.apply(Math, bucketList) / 50;\n        for (i = 0; i < bucketList.length; i++) {\n          bucketList[i] = Math.round(bucketList[i] / ratio);\n        }\n      }\n    const barDataValues = [];\n    for (let i = 0; i < bucketList.length; i++) {\n      barDataValues.push(bucketList[i] || 0);\n    }\n    // console.log(barDataValues)\n    return barDataValues;\n  }\n\n\n  hoverEffect(chartElement) {\n    this.setState({isHovering: true});\n    if (chartElement[0]) {\n      var barID = chartElement[0].index;\n      var arr = new Float32Array( this.props.settings[\"total\"] ).fill(1);\n      // var arr = !this.props.filterImageAr;\n      var prevArr = this.props.currentProjection;\n      // console.log(this.props.barData[\"selections\"][barID]);?\n      this.props.barData[\"selections\"][barID].forEach(element => {\n        // if (prevArr[element] === 1) {\n          arr[element] = prevArr[element]\n        // }\n        // console.log(this.props.barData[\"selections\"][barID])\n      });\n      this.props.calculateProjection(arr, null, false);\n      this.setState({barSelected: barID});\n    }\n  }\n\n  onLeave() { \n    // this.setState(() => ({isHovering: false}), () => console.log(this.state));\n    this.setState({isHovering: false});\n    this.props.calculateProjection(this.props.currentProjection, null, false)\n  }\n\n  // componentDidUpdate(prevProps) {\n  //   if (this.props.currentProjection !== prevProps.currentProjection) {\n  //     this.barDataIst = this.calculateFrequencyOfData(this.props.domain,this.props.datafilter,false);\n  //   }\n  // }\n\n\n  render() {\n    const { barData, domain, color, selected } = this.props;\n    defaults.animation = false;\n    var markerData = Array(50).fill(0);\n    this.barDataSoll = barData.histogram;\n    this.barDataIst = this.calculateHistogram(domain,false);\n    const barDataCalc = {\n      labels: this.barDataSoll.map((val, i) => i),\n      datasets: [\n        {\n          label: \"barDataIst\",\n          type: 'bar',\n          barThickness: 5,\n          normalized: true,\n          order: 2,\n          backgroundColor: this.state.isHovering ? \"rgb(64, 64, 64)\" : markerData.map((val, i) =>\n            i === this.bucketsFinder[parseFloat(selected).toFixed(1)]\n              ? \"#f50057\"\n              : color\n            ),\n          hoverBackgroundColor: color,\n          // backgroundColor: this.state.bgColor,\n\n          // backgroundColor: this.barDataIst.map((val, i) =>\n          // i === this.bucketsFinder[parseFloat(selected).toFixed(1)]\n          //   ? \"rgb(245, 0, 87)\"\n          //   : this.state.isHovering ? \"rgb(64, 64, 64)\" : color\n          // ),\n          data: this.barDataIst\n          },\n\n          {\n            label: \"barDataSoll\",\n            type: 'bar',\n            barThickness: 5,\n            normalized: true,\n            order: 3,\n            backgroundColor: markerData.map((val, i) =>\n            i === this.bucketsFinder[parseFloat(selected).toFixed(1)]\n              ? \"#542032\"\n              : \"rgb(64, 64, 64)\"\n            ),\n            hoverBackgroundColor: \"rgb(64, 64, 64)\",\n\n          //   backgroundColor: this.barDataIst.map((val, i) =>\n          //   i === this.bucketsFinder[parseFloat(selected).toFixed(1)]\n          //     ? \"rgb(255, 153, 189)\"\n          //     : \"rgb(64, 64, 64)\"\n          // ),\n            // hoverBackgroundColor: \"rgba(255,99,132,0.4)\",\n            data: this.barDataSoll\n          }\n      ]\n    };\n\n    // console.log(\"selected\",this.bucketsFinder[parseFloat(selected).toFixed(1)] );\n    const options = {\n      responsive: true,\n      // pointStyle: 'triangle',\n      interaction: {\n        mode: 'index',\n        intersect: false\n        },\n      events: ['mouseleave', \"mousemove\", \"mouseout\", \"click\"], //, 'touchstart', 'touchmove'],\n      hoverBackgroundColor: color,\n      onClick: () => {\n            this.setState({isHovering: !this.state.isHovering});\n            this.props.calculateProjection(this.props.currentProjection, null, false)\n      },\n      onHover: (event, chartElement) => {\n        if (event.type === \"mousemove\" && this.state.isHovering && this.state.barSelected !== chartElement[0].index) {\n          this.setState({bgColor: \"rgb(64, 64, 64)\"});\n          this.hoverEffect(chartElement)\n          if (event.native.target.style.cursor !== 'ew-resize') {\n            event.native.target.style.cursor = 'ew-resize';\n          }\n        } else if (!this.state.isHovering && event.native.target.style.cursor !== 'pointer') {\n            event.native.target.style.cursor = 'pointer';\n          }\n      // if (this.state.isHovering){\n      //   ReactTooltip.hide(this.fooRef)\n      // }\n      },\n      plugins: {\n        legend: {\n          display: false\n        },\n        tooltip: {\n          enabled: false\n        }\n      },\n      scales: {\n        x: {\n          display: false,\n          stacked: true,\n          // position: 'bottom'\n        },\n        yAxes: {\n          beginAtZero: true,\n          display: false,\n          // stacked: true,\n          // ticks: {\n          //   min: 100\n          // }\n        }\n      }\n    };\n\n\n    return (\n      <Bar data={barDataCalc} height={62} options={options} onMouseLeave={this.onLeave} />\n      );\n  }\n}\n\nexport default React.memo(BarChart);\n","import React from \"react\";\nimport { Grid, TextField, Tooltip, Button } from \"@material-ui/core\";\nimport { Slider, Rail, Handles, Tracks } from \"react-compound-slider\";\nimport { MuiRail, MuiHandle, MuiTrack } from \"./components\";\nimport BarChart from \"./BarChart\";\n\n\nclass RangeSlider extends React.Component {\n  constructor(props) {\n    super(props);\n    let data = props.datafilter;//.filter(() => true);\n    const range = [Math.min.apply(null, data),Math.max.apply(null, data)];\n    this.state = {\n      domain: range,\n      update: range,\n      values: range,\n      inputValues: range,\n      typeNumber: this.props.typeNumber,\n      step:props.step,\n      color:props.color,\n      hover_index: this.props.hover_index,\n      isToggleOn: false,\n    };\n\n    this.changeSlider = this.changeSlider.bind(this);\n    this.currentValues = range;\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  handleClick(e) {\n    this.setState(prevState => ({\n      isToggleOn: !prevState.isToggleOn\n    }));\n    e.stopPropagation();\n  }\n\n  changeSlider(values) {\n    this.currentValues = values;\n    this.props.onChangeSlider(this.props.title, values);\n  }\n\n\n  render() {\n    const { domain, values, update, inputValues, color, typeNumber } = this.state;\n    return (\n      <Grid container>\n        <Grid item xs={12}>\n          <div style={{ height: \"90px\", width: \"270px\", marginTop: \"12px\"}}>\n            <BarChart\n              update={update}\n              domain={domain}\n              color={color}\n              barData={this.props.barData}\n              calculateProjection={this.props.calculateProjection}\n              settings={this.props.settings}\n              currentProjection={this.props.currentProjection}\n              sliderID={this.props.sliderID}\n              metadata={this.props.metadata}\n              selected={this.props.metadata[this.props.hover_index][this.props.sliderID]}\n\n            />\n            \n            <Slider\n              mode={3}\n              step={typeNumber === \"int\"?1:0.01}\n              domain={domain}\n              color={color}\n              rootStyle={{\n                position: \"relative\",\n                width: \"100%\"\n              }}\n              onUpdate={(update) => {\n                this.setState({ update, inputValues: update });\n              }}\n              onChange={(values) => {\n                this.setState({ values });\n                this.changeSlider(update);\n              }}\n              values={values}\n            >\n              <Rail>\n                {({ getRailProps }) => <MuiRail getRailProps={getRailProps} />}\n              </Rail>\n              <Handles>\n                {({ handles, getHandleProps }) => (\n                  <div className=\"slider-handles\">\n                    {handles.map((handle) => (\n                      <MuiHandle\n                        key={handle.id}\n                        handle={handle}\n                        domain={domain}\n                        getHandleProps={getHandleProps}\n                      />\n                    ))}\n                  </div>\n                )}\n              </Handles>\n              <Tracks left={false} right={false}>\n                {({ tracks, getTrackProps }) => (\n                  <div className=\"slider-tracks\">\n                    {tracks.map(({ id, source, target }) => (\n                      <MuiTrack\n                        key={id}\n                        source={source}\n                        target={target}\n                        getTrackProps={getTrackProps}\n                      />\n                    ))}\n                  </div>\n                )}\n              </Tracks>\n            </Slider>\n            <Grid\n              container\n              alignItems=\"center\"\n              justifyContent=\"space-around\"\n              // style={{ marginTop: \"15px\" }}\n            >\n              <Grid\n                item\n                xs={3}\n                style={{\n                textAlign: \"right\",\n                border: \"solid 1px white\",\n                height:\"20px\",\n                marginLeft: 'auto',\n                marginRight: 'auto',\n                marginTop: 10,\n                }}\n              >\n                <TextField\n                  fullWidth\n                  variant=\"outlined\"\n                  label=\"\"\n                  size=\"small\"\n                  width=\"8px\"\n                  value={inputValues[0]}\n                  margin=\"none\"\n                  inputProps={{\n                    style: {\n                      color:\"white\",\n                      padding: 0,\n                      marginLeft: 2\n                    }\n                  }}\n                  onChange={(evt) => {\n                    const value = evt.target.value;\n                    const newState = [value, inputValues[1]];\n                    this.setState({ inputValues: newState });\n                    if (value && value >= domain[0]) {\n                      this.setState({ values: newState });\n                    }\n                  }}\n                />\n              </Grid>\n              <Grid item xs={4} style={{ textAlign: \"center\",  marginTop:\"6px\"}}>\n\n              <Tooltip title={<h3>{this.props.info}</h3>}>\n              <h3 style={{cursor: \"help\"}}>{this.props.title}</h3>\n              </Tooltip>\n              </Grid>\n              <Grid\n                item\n                xs={3}\n                style={{\n                textAlign: \"right\",\n                border: \"solid 1px white\",\n                height:\"20px\",\n                marginLeft: 'auto',\n                marginRight: 'auto',\n                marginTop: 10,\n                }}\n              >\n                <TextField\n                  fullWidth\n                  variant=\"outlined\"\n                  label=\"\"\n                  size=\"small\"\n                  value={inputValues[1]}\n                  margin=\"none\"\n                  inputProps={{\n                    style: {\n                      color:\"white\",\n                      padding: 0,\n                      marginLeft: 2\n                    }\n                  }}\n                  // style={{ paddingTop: \"2px\", paddingBottom: \"8px\",color: \"white\" }}\n                  onChange={(evt) => {\n                    const value = evt.target.value;\n                    const newState = [inputValues[0], value];\n                    this.setState({ inputValues: newState });\n                    if (value && value <= domain[1] && value >= values[0]) {\n                      this.setState({ values: newState });\n                    }\n                  }}\n                />\n              </Grid>\n            </Grid>\n          </div>\n        </Grid>\n      </Grid>\n    );\n  }\n}\n\nexport default React.memo(RangeSlider);\n","import React, { Component } from 'react';\nimport { Grid } from \"@material-ui/core\";\nimport RangeSlider from \"./RangeSlider\";\n//import uuid from 'react-uuid';\n\nclass Sliders extends Component {\n  constructor(props) {\n    super(props);\n\n    this.changeSlider = this.changeSlider.bind(this);\n    // create references for each slider\n    this.slidersAr = []\n    for (let element in this.props.settings.sliders) {\n      this.slidersAr.push( this.props.settings.sliders[element].id );\n    }\n    this.refSliders = {}\n    this.filterData = {}\n    this.filtered = {}\n\n    for(let i=0;i<this.slidersAr.length;i+=1){\n      this.refSliders[this.slidersAr[i]] = React.createRef();\n      // Initial values non filter\n      let filterVals = []\n      for (let element in this.props.metadata) {\n        filterVals.push( this.props.metadata[element][this.slidersAr[i]] );\n      }\n      this.filterData[this.slidersAr[i]] = filterVals\n    }\n    this.state = {\n      datafilter: this.filterData\n    }\n\n  }\n\n  changeSlider(componentName, values) {\n    console.log(componentName, values);\n    let {\n      metadata,\n    } = this.props\n    this.filtered[componentName] = new Float32Array( this.props.settings[\"total\"]).fill(0)\n    let filteredArr = new Float32Array( this.props.settings[\"total\"])\n\n    for(let element in metadata){\n      if(values[0] > metadata[element][componentName] ||\n          values[1] < metadata[element][componentName]\n          ){\n            this.filtered[componentName][element] = 1\n      }\n    }\n    let list = Object.values(this.filtered)\n    let arr = filteredArr.map((x, idx) => list.reduce((max, curr) => max + curr[idx], 0));\n    this.props.calculateProjection(arr, \"filter\", true)\n  }\n\n\n  render() {\n    let {\n      hover_index,\n      settings,\n      barData,\n    } = this.props;\n\n    const slidersSettings = settings['sliders'];\n    const SliderList = slidersSettings.map((slider) =>\n    <Grid item>\n      <RangeSlider\n        ref={this.refSliders[slider['id']]}\n        datafilter={this.state.datafilter[slider['id']]}\n        title={slider['title']}\n        info={slider['info']}\n        typeNumber={slider['typeNumber']}\n        color={slider['color']}\n        onChangeSlider={this.changeSlider}\n        hover_index={hover_index}\n        barData={barData[slider['id']]}\n        calculateProjection={this.props.calculateProjection}\n        currentProjection={this.props.currentProjection}\n        settings={settings}\n        sliderID={slider['id']}\n        metadata={this.props.metadata}\n        />\n      </Grid>\n    )\n\n    return (\n      <Grid container style={{ marginLeft: \"6px\"}}>\n        <Grid item >\n        {SliderList}\n        </Grid>\n      </Grid>\n    );\n  }\n}\n\nexport default Sliders\n","import React, { Component } from 'react'\nimport Sliders from \"./Sliders/Sliders\";\n\nclass SliderPane extends Component {\n  constructor(props) {\n    super(props);\n    this.sliderReset = this.sliderReset.bind(this);\n  }\n\n  sliderReset() {\n    console.log(\"reset range sliders\");\n  }\n\n  render() {\n    let {\n      metadata,\n      hover_index,\n    } = this.props;\n\n    return (\n      <Sliders\n        metadata={metadata}\n        settings={this.props.settings}\n        hover_index={hover_index}\n        barData={this.props.barData}\n        filterImageAr={this.props.filterImageAr}\n        calculateProjection={this.props.calculateProjection}\n        currentProjection={this.props.currentProjection}\n      />\n    )\n  }\n}\n\nexport default React.memo(SliderPane)","import React, { Component } from 'react'\nimport  _ from \"lodash\";\nimport { Button, ButtonGroup } from \"@material-ui/core\";\nimport ReactFilterBox, {SimpleResultProcessing, GridDataAutoCompleteHandler} from \"react-filter-box\";\nimport \"./filter-box.css\";\n\n//Extend this class to add your custom operator\nclass CustomAutoComplete extends GridDataAutoCompleteHandler {\n    // Override this method to add new your operator\n    needOperators(parsedCategory) {\n        var result = super.needOperators(parsedCategory);\n        return result.concat([\"startsWith\"]);\n    }\n}\n\nclass CustomResultProcessing extends SimpleResultProcessing {\n    // Override this method to add your handler for startsWith operator\n    filter(row, fieldOrLabel, operator, value){\n        var field = this.tryToGetFieldCategory(fieldOrLabel);\n        switch(operator){\n            case \"==\": return row[field] === value;\n            case \"!=\": return row[field] !== value;\n            case \"contains\": return row[field].toLowerCase().indexOf(value.toLowerCase()) >=0;\n            case \"!contains\": return row[field].toLowerCase().indexOf(value.toLowerCase()) <0;\n            case \"startsWith\": return  _.startsWith(row[field].toLowerCase(), value.toLowerCase() ) ;\n            default: return false;\n        }\n    }\n}\n\nclass Filterbox extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            parseOK: true,\n            query2: {}\n        };\n        this.applyFilter = this.applyFilter.bind(this);\n        this.resetFilter = this.resetFilter.bind(this);\n        this.options = this.props.settings.search;\n        this.customAutoComplete = new CustomAutoComplete(this.props.metadata,this.options);\n        // this.editorConfig = {\n        //     direction: \"rtl\"\n        // };\n    }\n\n    applyFilter() {\n        var newData = new CustomResultProcessing(this.options).process(this.props.metadata, this.state.query2);\n        var arr = new Float32Array(this.props.settings[\"total\"]).fill(1);\n        newData.forEach(element => {\n            arr[element[\"index\"]] = 0;\n        });     \n        this.props.calculateProjection(arr, \"search\", true);\n    }\n\n    resetFilter() {\n        this.setState({ query: null, query2: '' });\n        var arr = new Float32Array(this.props.settings[\"total\"]).fill(0);\n        this.props.calculateProjection(arr, \"search\", true);\n    }\n\n    //customer your rendering item in auto complete\n    customRenderCompletionItem(self, data, pick) {\n        var className = `hint-value cm-${data.type}`\n        return <div className={className} >\n                    <span style={{ fontWeight: \"bold\" }}>{data.value}</span>\n                    <span style={{color:\"gray\", fontSize:10}}> [{data.type}] </span>\n                </div>\n    }\n\n    onParseOk(expressions) {\n        this.setState({ parseOK: false });\n        this.setState({ query2: expressions });\n        // this.applyFilter(expressions);\n    }\n\n    onParseError(expressions) {\n        this.setState({ parseOK: true });\n    }\n    \n    exportMetadata = () => {\n        var filteredMetadata = [];\n        for (let i = 0; i < this.props.metadata.length; i++) {\n          if (this.props.currentProjection[i] === 0) {\n            var obj = this.props.metadata[i];\n            filteredMetadata.push(obj);\n          }\n        }\n        this.setState(\n          { filterDataToExportCSV: filteredMetadata },\n          () => {\n            document.getElementsByClassName('hidden')[0].click();\n          }\n        );\n      };\n      \n\n    render() {\n        return (\n        <div className=\"main-container\">\n            <ReactFilterBox\n                autoCompleteHandler = {this.customAutoComplete}\n                customRenderCompletionItem = {this.customRenderCompletionItem.bind(this) }\n                query={this.state.query}\n                data={this.props.metadata}\n                options={this.options}\n                onParseOk={this.onParseOk.bind(this) }\n                onParseError={this.onParseError.bind(this) }\n                editorConfig={{ lineWrapping: true }}\n            />\n\n            <ButtonGroup variant=\"contained\">\n            <Button onClick={this.applyFilter}>apply</Button>\n            <Button onClick={this.resetFilter}>reset</Button>\n            </ButtonGroup>\n\n        </div>\n        )\n    }\n}\n\nexport default Filterbox","import React, { Component } from 'react'\nimport { Grid } from \"@material-ui/core\";\n//import _ from \"lodash\";\nimport Filterbox from \"./QueryFilter\";\n\nclass FilterPane extends Component {\n\n  render() {\n    let {\n      metadata,\n      settings,\n    } = this.props\n\n    return (\n      <Grid container spacing={2}>\n        <Filterbox \n          calculateProjection={this.props.calculateProjection}\n          settings={settings}\n          metadata={metadata}\n          currentProjection={this.props.currentProjection}\n          allFilter={this.props.allFilter}\n        />\n      </Grid>\n    )\n  }\n}\n\nexport default React.memo(FilterPane)","import React, { Component, Fragment } from 'react'\nimport { Grid } from \"@material-ui/core\";\nimport uuid from 'react-uuid';\n\nclass InfoFields extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n    }\n\n    render() {\n        let {\n            metadata,\n            hover_index,\n            infos,\n        } = this.props;\n\n        const linkStyle = {\n            color: 'CornflowerBlue'\n        };\n\n        const InfoList = infos.map((info) => \n            <Fragment>\n                <Grid key={uuid()} item xs={4}>\n                    {info}:\n                </Grid>\n                <Grid key={uuid()} item xs={8}>   \n                    {( typeof  metadata[hover_index][info] === 'string' && metadata[hover_index][info].length>4 && metadata[hover_index][info].substring(0, 4)==='http')  ? <a href={metadata[hover_index][info]} target=\"_blank\" rel=\"noreferrer\" style={linkStyle}>wikiart.org</a>: metadata[hover_index][info]}\n                </Grid>\n            </Fragment>\n        )\n\n        return (\n            <Grid key={uuid()} container justifyContent=\"space-between\" spacing={1} wrap=\"wrap\">    \n                <Grid key={uuid()} item xs={12}>   \n                    <b>{metadata[hover_index].Title}</b>\n                </Grid>\n                {InfoList}\n\n            </Grid>\n        );\n    }\n}\n\nexport default InfoFields","import React, { Component } from 'react'\nimport InfoFields from \"./InfoFields\";\n\nclass InfoPane extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      dimensions: {},\n    };\n  }\n\n  render() {\n    let {\n      hover_index,\n      infos,\n      metadata,\n    } = this.props;\n\n    return (\n      <InfoFields\n      metadata={metadata}\n      hover_index={hover_index}\n      infos={infos}\n      />\n    )\n\n  }\n}\n\nexport default React.memo(InfoPane)\n","import React, { Component } from 'react'\nimport { Grid, Slider, Box } from \"@material-ui/core\";\n\nclass ViewPane extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      dimensions: {},\n      checked: this.props.filterGrey\n    }\n  }\n\n  handleChange = () => {\n    this.setState(prevState => ({\n      checked: !prevState.checked\n    }));\n    this.props.handleChangeGrey(this.state.checked ? 1 : 0);\n  }\n\n  render() {\n    let {\n      clusters\n    } = this.props\n\n    return (\n      <Grid container spacing={1}>\n        \n          \n          <Grid item xs={4}>\n            clusters:\n          </Grid>\n          <Grid item xs={8}>\n            <select onChange={this.props.handleChangeCluster}>\n              <option key=\"0\" value=\"disabled\">-</option>\n              {clusters['clusterList'].map((option, index) => (\n              <option key={option} value={option}>\n                  {option.toLowerCase()}\n              </option>\n              ))}\n            </select> \n          </Grid>\n          <Grid item xs={4}>\n            size (out):\n          </Grid>\n          <Grid item xs={8}>\n          <Box height={10}>\n          <Slider\n            size=\"small\"\n            defaultValue={this.props.scaleMin}\n            min={3}\n            max={60}\n            onChange={this.props.handleChangeScale}\n          />\n          </Box>\n          </Grid>\n          <Grid item xs={4}>\n          size (in):\n          </Grid>\n          <Grid item xs={8}>\n          <Box height={10}>\n          <Slider\n            size=\"small\"\n            defaultValue={this.props.scaleMax}\n            min={3}\n            max={120}\n            onChange={this.props.handleChangeZoom}\n          />\n          </Box>\n          </Grid>\n\n          <Grid item xs={11}>\n          show filtered-out items (slower):\n          </Grid>\n          <Grid item xs={1}>\n            <input type=\"checkbox\" \n            checked={this.state.checked} \n            onChange={this.handleChange}\n            />\n          </Grid>\n\n      </Grid>\n    )\n  }\n}\n\nexport default React.memo(ViewPane)\n","import React, { Component } from 'react'\nimport { Grid } from \"@material-ui/core\";\n\nclass MappingsPane extends Component {\n  constructor(props) {\n    super(props)\n    this.handleSelectAlgorithm = this.handleSelectAlgorithm.bind(this);\n    this.handleSelectDataset = this.handleSelectDataset.bind(this);\n  }\n\n  handleSelectAlgorithm(e) {\n    let v = e.target.value;\n    this.props.selectAlgorithm(v);\n  }\n\n  handleSelectDataset(e) {\n    let v = e.target.value;\n    this.props.selectDataset(v);\n  }\n\n  render() {\n    let {\n      algorithm_options,\n      algorithm_choice,\n      dataset_options,\n      selectedDataset,\n      datasetInfo\n    } = this.props;\n\n    return (\n      \n      <Grid container spacing={1}>\n          <Grid item xs={4}>\n            Dataset:\n          </Grid>\n          <Grid item xs={8}>\n            <select className=\"full-width\"\n              onChange={this.handleSelectDataset}\n              value={selectedDataset}\n            >\n              {dataset_options.map((option, index) => (\n              <option key={option} value={option}>\n                  {option}\n              </option>\n              ))}\n            </select>\n          </Grid>\n\n          <Grid item xs={4}>\n            Projection:\n          </Grid>\n          <Grid item xs={8}>\n            <select className=\"full-width\"\n              onChange={this.handleSelectAlgorithm}\n              value={algorithm_options[algorithm_choice]}\n            >\n              {algorithm_options.map((option, index) => (\n              <option key={option} value={option}>\n                  {option}\n              </option>\n              ))}\n            </select>\n          </Grid>\n          <Grid item xs={12}>\n          <p className=\"info\">{datasetInfo}</p>\n          </Grid>\n      </Grid>\n    )\n  }\n}\n\nexport default React.memo(MappingsPane)","\nimport React, { Component } from 'react'\nimport { Button } from \"@material-ui/core\";\nimport { CSVLink } from \"react-csv\";\nimport canvasToImage from 'canvas-to-image';\n\n\nclass Export extends Component {\n    constructor(props) {\n      super(props)\n      this.state = {\n        filterDataToExportCSV:[],\n    }\n    }\n\n    makePNG = async () => {\n        console.log('download projection area as png')\n        canvasToImage(document.getElementById(\"threeCanvas\"));\n      }\n\n  \n\nrender() {\n    let {\n        metadata,\n        currentProjection\n      } = this.props;\n\n    return (\n        <><div style={{ marginBottom: \"12px\" }}>\n        <CSVLink \n            data={this.state.filterDataToExportCSV} \n            filename={\"CSN_filtered_metadata.csv\"} \n            target=\"_blank\"\n            onClick={() => {\n            let filteredMetadata = [];\n            for (let i=0;i<metadata.length;i++) {\n                if(currentProjection[i]===0){\n                var obj = metadata[i];\n                filteredMetadata.push(obj)\n                }\n            }\n            this.setState({filterDataToExportCSV: filteredMetadata});\n            }}                \n            >\n            <Button variant=\"contained\" fullWidth >Download metadata CSV</Button>\n            </CSVLink>\n            </div><div>\n                <Button variant=\"contained\" fullWidth onClick={this.makePNG}>Download projection PNG</Button>\n            </div></>\n\n    )\n\n\n}\n  \n    // // Release memory of export filter metadata\n    // if(this.state.filterDataToExportCSV.length>0) this.setState({filterDataToExportCSV: []});\n\n\n}\n\nexport default React.memo(Export)\n\n","import React, { Component } from 'react'\nimport * as THREE from 'three'\nimport * as _ from 'lodash'\nimport * as d3 from 'd3'\nimport * as TWEEN from '@tweenjs/tween.js'\nimport { CircularProgress } from \"@material-ui/core\";\n\nclass Projection extends Component {\n  constructor(props) {\n    super(props)\n    this.loadTiles()\n    this.state = {\n      tilesLoaded: 0,\n      view: null\n    }\n    this.init = this.init.bind(this)\n    this.pointsAr = []\n    this.addPoints = this.addPoints.bind(this)\n    this.handleResize = this.handleResize.bind(this)\n    this.setupCamera = this.setupCamera.bind(this)\n    this.animate = this.animate.bind(this)\n    this.getScaleFromZ = this.getScaleFromZ.bind(this)\n    this.getZFromScale = this.getZFromScale.bind(this)\n    this.changeEmbeddings = this.changeEmbeddings.bind(this)\n  }\n\n  loadTiles(){ \n    this.sprite_size = this.props.settings.sprite_side * this.props.settings.sprite_side\n    this.tile_locations = [...Array(this.props.settings.sprite_number)].map(\n      (n, i) => `${process.env.PUBLIC_URL}/datasets/${this.props.settings.sprite_dir}/tile_${i}.png`\n    )  \n    this.datasetIMG = this.tile_locations.map(src => {\n      let img = document.createElement('img')\n      img.src = src\n      return img\n    })\n  }\n\n  //changeEmbeddings(prev_choice, new_choice) {\n  changeEmbeddings(new_choice) {\n    let ranges = []\n    for (let i = 0; i < this.props.settings.sprite_number; i++) {\n      let start = i * this.sprite_size\n      let end = (i + 1) * this.sprite_size\n      if (i === this.props.settings.sprite_number - 1) end = this.props.settings.sprite_number * this.sprite_size\n      ranges.push([start, end])\n    }\n\n    let embedding_chunks = ranges.map(range =>\n      this.props.mappings[new_choice].slice(\n        range[0],\n        range[1]\n      )\n    )\n\n    for (let c = 0; c < this.props.settings.sprite_number; c++) {\n      let echunk = embedding_chunks[c]\n\n      let points = this.scene.children[0].children[c]\n      let numVertices = echunk.length\n\n      let position = points.geometry.attributes.position.array\n      let target = new Float32Array(numVertices * 3)\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 3) {\n        let x = echunk[i][0]\n        let y = echunk[i][1]\n        let z = 0\n        target[index] = x\n        target[index + 1] = y\n        target[index + 2] = z\n      }\n\n      let tween = new TWEEN.Tween(position)\n        .to(target, 1000)\n        .easing(TWEEN.Easing.Linear.None)\n      tween.onUpdate(function() {\n        points.geometry.attributes.position = new THREE.BufferAttribute(\n          position,\n          3\n        )\n        points.geometry.attributes.position.needsUpdate = true // required after the first render\n      })\n      tween.start();\n    }\n  }\n\n  zoomScaler(input) {\n    let scaleProj = d3\n    .scaleLinear()\n    .domain([20,0])\n    .range([this.props.scaleMin, this.props.scaleMax])\n    .clamp(true);\n    return scaleProj(input);\n  }\n\n  getZFromScale(scale) {\n    let rvFOV = THREE.Math.degToRad(this.camera.fov);\n    let scale_height = this.props.height / scale;\n    let camera_z_position = scale_height / (2 * Math.tan(rvFOV / 2));\n    return camera_z_position;\n  }\n\n  getScaleFromZ(camera_z_position) {\n    let rvFOV = THREE.Math.degToRad(this.camera.fov);\n    let half_fov_height = Math.tan(rvFOV / 2) * camera_z_position;\n    let fov_height = half_fov_height * 2;\n    let scale = this.props.height / fov_height;\n    return scale;\n  }\n\n  handleResize = (width, height) => {\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(width, height);\n    let current_scale = this.getScaleFromZ(this.camera.position.z);\n    let d3_x = -(this.camera.position.x * current_scale) + this.props.width / 2;\n    let d3_y = this.camera.position.y * current_scale + this.props.height / 2;\n    var resize_transform = d3.zoomIdentity\n      .translate(d3_x, d3_y)\n      .scale(current_scale);\n    let view = d3.select(this.mount);\n    this.d3_zoom.transform(view, resize_transform);\n  }\n\n  zoomHandler() {\n    let d3_transform = d3.event.transform;\n    let scale = d3_transform.k;\n    let x = -(d3_transform.x - this.props.width / 2) / scale;\n    let y = (d3_transform.y - this.props.height / 2) / scale;\n    let z = this.getZFromScale(scale);\n    this.camera.position.set(x, y, z);\n    // point size scales at end of zoom\n    let new_size = this.zoomScaler(z);\n    let point_group = this.scene.children[0].children;\n    for (let c = 0; c < point_group.length; c++) {\n      point_group[c].material.uniforms.size.value = new_size;\n    }\n  }\n\n  setupCamera() {\n    let { width, height, embeddings_data } = this.props\n\n    let vFOV = this.camera.fov\n    let rvFOV = THREE.Math.degToRad(vFOV)\n\n    let xs = embeddings_data.map(e => e[0])\n    let min_x = _.min(xs)\n    let max_x = _.max(xs)\n    let ys = embeddings_data.map(e => e[1])\n    let min_y = _.min(ys)\n    let max_y = _.max(ys)\n\n    let max_x_from_center = _.max([min_x, max_x].map(m => Math.abs(m)))\n    let max_y_from_center = _.max([min_y, max_y].map(m => Math.abs(m)))\n\n    let max_center = Math.max(max_x_from_center, max_y_from_center)\n\n    let camera_z_start\n    // if (data_aspect > aspect) {\n    //   // console.log(\"width is limiter\");\n    //   // camera_z_start = max_x_from_center / Math.tan(rvFOV / 2) / aspect\n    // } else {\n    //   // console.log(\"height is limiter\");\n    //   // camera_z_start = max_y_from_center / Math.tan(rvFOV / 2)\n    // }\n\n    camera_z_start = max_center / Math.tan(rvFOV / 2)\n\n    let far = camera_z_start * 1.25\n    this.camera.far = far\n    this.camera.position.z = camera_z_start * 1.1\n\n    // set up zoom\n    this.d3_zoom = d3\n      .zoom()\n      .scaleExtent([this.getScaleFromZ(far - 1), this.getScaleFromZ(0.1)])\n      .on('zoom', this.zoomHandler.bind(this))\n\n    let view = d3.select(this.mount)\n    this.view = view\n    view.call(this.d3_zoom)\n    let initial_scale = this.getScaleFromZ(this.camera.position.z)\n    var initial_transform = d3.zoomIdentity\n      .translate(width / 2, height / 2)\n      .scale(initial_scale)\n    this.d3_zoom.transform(view, initial_transform)\n    this.setState({ view: view })\n  }\n\n  addPoints() {\n    let { embeddings_data,metadata } = this.props;\n\n    // split embeddings and labels into chunks to match sprites\n    let ranges = [];\n    for (let i = 0; i < this.props.settings.sprite_number; i++) {\n      let start = i * this.sprite_size;\n      let end = (i + 1) * this.sprite_size;\n      if (i === this.props.settings.sprite_number - 1) end = this.props.settings.sprite_number * this.sprite_size;\n      ranges.push([start, end]);\n    }\n    let embedding_chunks = ranges.map(range =>\n      embeddings_data.slice(range[0], range[1])\n    );\n\n    // load the textures\n    let loader = new THREE.TextureLoader();\n    this.textures = this.tile_locations.map(l => {\n      let t = loader.load(l,\n        function ( w ) {\n          this.setState({ tilesLoaded: this.state.tilesLoaded+1 });\n        }.bind(this)\n      )\n      t.flipY = false\n      t.magFilter = THREE.NearestFilter\n      return t\n    })  \n    let geometry;\n    let point_group = new THREE.Group();\n    for (let c = 0; c < this.props.settings.sprite_number; c++) {\n      let echunk = embedding_chunks[c];\n      //let lchunk = label_chunks[c]\n\n      let vertices = [];\n      for (let v = 0; v < echunk.length; v++) {\n        let embedding = echunk[v];\n        let vert = new THREE.Vector3(embedding[0], embedding[1], 0);\n        vertices[v] = vert;\n      }\n\n      geometry = new THREE.BufferGeometry();\n\n      let numVertices = vertices.length;\n      console.log(\"numVertices -->\",numVertices)\n      let positionAr = new Float32Array(numVertices * 3);\n      let offsetAr = new Float32Array(numVertices * 2);\n      let clusterAr = new Float32Array(numVertices * 3);\n      let filterAr = new Float32Array(numVertices );\n      //let clustersActive = new Float32Array(numVertices );\n      geometry.addAttribute('position', new THREE.BufferAttribute(positionAr, 3));\n      geometry.addAttribute('offset', new THREE.BufferAttribute(offsetAr, 2));\n      geometry.addAttribute('filter', new THREE.BufferAttribute(filterAr, 1));\n      geometry.addAttribute('cluster', new THREE.BufferAttribute(clusterAr, 3));\n      //geometry.addAttribute('clusterActive', new THREE.BufferAttribute(clustersActive, 1));\n\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 3) {\n        let x = echunk[i][0];\n        let y = echunk[i][1];\n        let z = 0;\n        positionAr[index] = x;\n        positionAr[index + 1] = y;\n        positionAr[index + 2] = z;\n      }\n      // geometry.attributes.position.copyVector3sArray(vertices)\n\n      let texture_subsize = 1 / this.props.settings.sprite_side;\n\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 2) {\n        let x = ((i % this.props.settings.sprite_side) * this.props.settings.sprite_image_size) / this.props.settings.sprite_actual_size\n        let y =\n          (Math.floor(i / this.props.settings.sprite_side) * this.props.settings.sprite_image_size) / this.props.settings.sprite_actual_size\n        offsetAr[index] = x;\n        offsetAr[index + 1] = y;\n      }\n      if (this.props.settings.clusters.clusterList) {\n        // Todo: connect cluster the array\n        let clusterSelected = this.props.clusterTypeSelected;\n        let clusterColors = this.props.settings.clusters.clusterColors;\n        console.log(\"clusterSelected\",clusterSelected)\n        for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 1) {\n          // Images disable when are not visible\n          filterAr[index] = 0.0;// default value to show all images\n\n          // Clusters visualization\n\n          if( clusterSelected !== \"-\" && this.props.settings.clusters.clusterList.includes(clusterSelected) ){ \n              let clusterId = metadata[index][clusterSelected];\n              if(clusterId >= clusterColors.length){\n                clusterAr[index*3] = 1.0;\n                clusterAr[index*3 + 1] = 1.0;\n                clusterAr[index*3 + 2] = 1.0;\n              }else{\n                clusterAr[index*3] = clusterColors[clusterId][0];\n                clusterAr[index*3 + 1] = clusterColors[clusterId][1];\n                clusterAr[index*3 + 2] = clusterColors[clusterId][2];\n              }\n          }\n      }\n    }\n      // uniforms\n      let uniforms = {\n        texture: { value: this.textures[c] },\n        repeat: { value: new THREE.Vector2(texture_subsize, texture_subsize) },\n        size: { value: this.props.settings.sprite_image_size },\n        greyTransparency:{ value:0.1},\n        imageTransparency:{ value:1.0},\n        clusterActive:{ value:0.0}\n      };\n\n      let vertex_shader = `\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        attribute vec3 cluster;\n        varying vec3 vCluster;\n        attribute float filteredActive;\n        varying float vFilteredActive;\n        uniform float clusterActive;\n        varying float vClusterActive;\n        uniform float size;\n        uniform float greyTransparency;\n        varying float vGreyTransparency;\n        uniform float imageTransparency;\n        varying float vImageTransparency;\n\n        void main() {\n          vOffset = offset;\n          vFilteredActive = filteredActive;\n          vCluster = cluster;\n          vClusterActive = clusterActive;\n          vGreyTransparency = greyTransparency;\n          vImageTransparency = imageTransparency;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }`;\n\n      let fragment_shader = `\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        varying vec3 vCluster;\n        varying float vClusterActive;\n        varying float vFilteredActive;\n        varying float vGreyTransparency;\n        varying float vImageTransparency;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          // make transparent images\n          if ( tex.a < 0.003 ) discard;\n\n          // Display clusters\n          vec4 replace_color = vec4(vCluster,1.0);\n          vec4 default_border_color = vec4(0.00392156863,0.00392156863,0.00392156863,0.00392156863);\n          vec4 diff = tex - default_border_color;\n          float equality = float(dot(diff,diff) < 0.99 && vClusterActive > 0.9);\n          tex = mix( tex, replace_color, equality);\n           \n          // make transparent images\n          tex = mix( tex,  vec4(0.0,0.0,0.0,0.0), vImageTransparency);\n\n          // Grey images filter our selection \n          vec4 filterout_color = vec4(0.3,0.3,0.3,vGreyTransparency);\n          float filterout_equality = float(vFilteredActive > 0.9);\n          tex = mix( tex, filterout_color, filterout_equality );\n          gl_FragColor = tex; //* vec4(vColor, 1.0);\n        }`;\n\n      // material\n      let material = new THREE.ShaderMaterial({\n        uniforms: uniforms,\n        vertexShader: vertex_shader,\n        fragmentShader: fragment_shader,\n        transparent: true\n      });\n\n      // point cloud\n      let point_cloud = new THREE.Points(geometry, material);\n      point_cloud.userData = { sprite_index: c };\n      this.pointsAr.push(point_cloud);\n      // console.log(\"new points\")\n      point_group.add(point_cloud);\n    }\n    this.scene.add(point_group);\n  }\n\n  addBlankHighlightPoints() {\n    let hover_container = new THREE.Group();\n    this.scene.add(hover_container);\n\n    let vert = new THREE.Vector3(0, 0, 0);\n    let vertices = [vert];\n    let geometry = new THREE.BufferGeometry();\n    let numVertices = vertices.length;\n    var positionAr = new Float32Array(numVertices * 3); // 3 coordinates per point\n    var offsetAr = new Float32Array(numVertices * 2); // 2 coordinates per point\n    geometry.addAttribute('position', new THREE.BufferAttribute(positionAr, 3));\n    geometry.addAttribute('offset', new THREE.BufferAttribute(offsetAr, 2));\n\n    // all the attributes will be filled on hover\n    let texture_subsize = 1 / this.props.settings.sprite_side;\n\n    // uniforms\n    let uniforms = {\n      texture: { value: this.textures[0] },\n      repeat: { value: new THREE.Vector2(texture_subsize, texture_subsize) },\n      size: { value: 84.0 }, //56\n    };\n\n    let vertex_shader = `\n        attribute vec2 offset;\n        varying vec2 vOffset;\n        uniform float size;\n        void main() {\n          vOffset = offset;\n          gl_PointSize = size;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }`;\n\n    let fragment_shader = `\n        uniform sampler2D texture;\n        uniform vec2 repeat;\n        varying vec2 vOffset;\n        void main() {\n          vec2 uv = vec2( gl_PointCoord.x, gl_PointCoord.y );\n          vec4 tex = texture2D( texture, uv * repeat + vOffset );\n          gl_FragColor = tex;\n        }`;\n\n    // material\n    var material = new THREE.ShaderMaterial({\n      uniforms: uniforms,\n      vertexShader: vertex_shader,\n      fragmentShader: fragment_shader,\n      transparent: true,\n    });\n\n    let point = new THREE.Points(geometry, material);\n    point.frustumCulled = false;\n\n    this.scene.children[1].visible = false;\n    this.scene.children[1].add(point);\n  }\n\n  // filter images - update color of images to get inactive (grey) or active images\n  updateProjection=(ar)=>{\n    this.filterAr = ar;\n    let ranges = [];\n    let ar_sliced = [];\n    for (let i = 0; i < this.props.settings.sprite_number; i++) {\n      let start = i * this.sprite_size;\n      let end = (i + 1) * this.sprite_size;\n      if (i === this.props.settings.sprite_number - 1) end = this.props.settings.sprite_number * this.sprite_size;\n      ranges.push([start, end]);\n      ar_sliced.push(ar.slice(start, end));\n    }\n    // \n    for (let c = 0; c < this.props.settings.sprite_number; c++) {\n      let points = this.scene.children[0].children[c];\n      points.geometry.attributes.filteredActive = new THREE.BufferAttribute(\n        ar_sliced[c],\n        1\n      );\n      points.geometry.attributes.filteredActive.needsUpdate = true;\n    }\n    // let point = this.scene.children[0].children[0]\n    // console.log(point.geometry);\n  }\n\n  updatePass2Shader=(num)=>{\n    for (let c = 0; c < this.props.settings.sprite_number; c++) {\n      let points = this.scene.children[0].children[c];\n      if(num===1){\n        points.material.uniforms.greyTransparency.value = 0.1;\n        points.material.uniforms.greyTransparency.needsUpdate = true;\n        points.material.uniforms.imageTransparency.value = 1.0;\n        points.material.uniforms.imageTransparency.needsUpdate = true;\n      }\n      if(num===2){\n        points.material.uniforms.greyTransparency.value = 0.0;\n        points.material.uniforms.greyTransparency.needsUpdate = true;\n        points.material.uniforms.imageTransparency.value = 0.0;\n        points.material.uniforms.imageTransparency.needsUpdate = true;\n      }\n    }\n  }\n\n  updateClusterColors=(clusterSelected)=>{\n    console.log('updateClusterColors',clusterSelected);\n    \n    let numVertices =  this.props.metadata.length;//this.props.settings.sprite_number * this.sprite_size;\n    console.log(\"clusterSelected:\",clusterSelected, \"numVertices Update -->\",numVertices, ' metadata.length:', this.props.metadata.length)\n    let clusters = new Float32Array(numVertices * 3);\n    //let clustersActive = new Float32Array(numVertices );\n    let clusterColors = this.props.settings.clusters.clusterColors;\n    console.log(numVertices,clusterSelected !==\"-\",this.props.settings.total,clusterColors);\n    \n    let ranges = [];\n    // let clustersActiveAr_sliced = [];\n    let clustersAr_sliced = [];\n\n    if( clusterSelected !==\"disabled\" ){\n      for (let i = 0, index = 0, l = numVertices; i < l; i++, index += 1) {\n          let clusterId = this.props.metadata[index][clusterSelected];\n          if(clusterId>=clusterColors.length){\n            clusters[index*3] = 1.0;\n            clusters[index*3 + 1] = 1.0;\n            clusters[index*3 + 2] = 1.0;\n          }else{\n            clusters[index*3] = clusterColors[clusterId][0];\n            clusters[index*3 + 1] = clusterColors[clusterId][1];\n            clusters[index*3 + 2] = clusterColors[clusterId][2];\n          }\n      }\n\n      for (let i = 0; i < this.props.settings.sprite_number; i++) {\n        let start = i * this.sprite_size;\n        let end = (i + 1) * this.sprite_size;\n        if (i === this.props.settings.sprite_number - 1) end = this.props.settings.sprite_number * this.sprite_size;\n        ranges.push([start, end]);\n        clustersAr_sliced.push(clusters.slice(start*3, end*3));\n      }\n    }\n    \n    for (let c = 0; c < this.props.settings.sprite_number; c++) {\n      let points = this.scene.children[0].children[c];\n      if( clusterSelected !==\"disabled\" ){\n        points.geometry.attributes.cluster = new THREE.BufferAttribute(\n          clustersAr_sliced[c],\n          3\n        );\n        points.geometry.attributes.cluster.needsUpdate = true;\n        \n        points.material.uniforms.clusterActive.value = 1.0;\n        points.material.uniforms.clusterActive.needsUpdate = true;\n      }else{\n        points.material.uniforms.clusterActive.value = 0.0;\n        points.material.uniforms.clusterActive.needsUpdate = true;\n      }\n    }\n\n\n  }\n\n  highlightPoint(sprite_index, digit_index, full_index) {    \n    let { algorithm_choice, mappings } = this.props;\n\n    let point = this.scene.children[1].children[0];\n\n    // console.log(mappings[algorithm_choice][full_index]);\n    let embedding = mappings[algorithm_choice][full_index];\n\n    let vert = new THREE.Vector3(embedding[0], embedding[1], 0);\n    let vertices = [vert];\n\n    var offsets = new Float32Array(2); // 2 coordinates per point\n\n    let x = ((digit_index % this.props.settings.sprite_side) * this.props.settings.sprite_image_size) / 2048;\n    let y = (Math.floor(digit_index / this.props.settings.sprite_side) * this.props.settings.sprite_image_size) / 2048;\n    offsets[0] = x;\n    offsets[1] = y;\n\n    point.geometry.attributes.position.copyVector3sArray(vertices);\n    point.geometry.attributes.position.needsUpdate = true; // required after the first render\n    point.geometry.attributes.offset.array = offsets;\n    point.geometry.attributes.offset.needsUpdate = true; // required after the first render\n\n    // need to set attributes on geometry and uniforms on material\n    point.material.uniforms.texture.value = this.textures[sprite_index];\n  }\n\n  removeHighlights() {\n    let highlight_container = this.scene.children[1];\n    let highlights = highlight_container.children;\n    highlight_container.remove(...highlights);\n  }\n\n  checkIntersects(mouse_position) {\n    let { width, height, previewPane_ctx, previewPane_image_size } = this.props;\n\n    function mouseToThree([mouseX, mouseY]) {\n      return new THREE.Vector3(\n        (mouseX / width) * 2 - 1,\n        -(mouseY / height) * 2 + 1,\n        1\n      );\n    }\n\n    function sortIntersectsByDistanceToRay(intersects) {\n      return _.sortBy(intersects, 'distanceToRay');\n    }\n\n    let mouse_vector = mouseToThree(mouse_position);\n    this.raycaster.setFromCamera(mouse_vector, this.camera);\n    this.raycaster.params.Points.threshold = 0.25;\n    let intersects = this.raycaster.intersectObjects(\n      this.scene.children[0].children\n    );\n    if (intersects[0]) {\n      let sorted_intersects = sortIntersectsByDistanceToRay(intersects);\n      let intersect = sorted_intersects[0];\n      let sprite_index = intersect.object.userData.sprite_index;\n      let digit_index = intersect.index;\n      let full_index = sprite_index * this.sprite_size + digit_index;\n      // if filter is null then allow selected all, then when filter is defined only allow visible image to be selected\n      if( this.filterAr===undefined || this.filterAr[full_index]<1.0){\n        this.props.setHoverIndex(full_index);\n        // console.log(full_index)\n        this.highlightPoint(sprite_index, digit_index, full_index);\n        this.scene.children[1].visible = true;\n        previewPane_ctx.clearRect(0, 0,  previewPane_image_size, previewPane_image_size);\n        previewPane_ctx.fillRect(0, 0, previewPane_image_size, previewPane_image_size);\n        previewPane_ctx.fillStyle = \"transparent\";\n        try{\n          previewPane_ctx.drawImage(\n            this.datasetIMG[sprite_index],\n            // source rectangle\n            (digit_index % this.props.settings.sprite_side) * this.props.settings.sprite_image_size,\n            Math.floor(digit_index / this.props.settings.sprite_side) * this.props.settings.sprite_image_size,\n            this.props.settings.sprite_image_size,\n            this.props.settings.sprite_image_size,\n            // destination rectangle\n            0,\n            0,\n            previewPane_image_size,\n            previewPane_image_size\n          );\n        }catch (error){\n          console.log(\"previewPane_ctx.drawImage\",error);\n        }\n      }\n    } else {\n      this.props.setHoverIndex(null);\n      this.scene.children[1].visible = false;\n      previewPane_ctx.fillRect(0, 0, previewPane_image_size, previewPane_image_size);\n      previewPane_ctx.fillStyle = \"transparent\";\n    }\n  }\n\n  handleMouse() {\n    let view = d3.select(this.renderer.domElement);\n    this.raycaster = new THREE.Raycaster();\n\n    view.on('mousemove', () => {\n      let [mouseX, mouseY] = d3.mouse(view.node());\n      let mouse_position = [mouseX, mouseY];\n      this.checkIntersects(mouse_position);\n    })\n    \n    view.on('dblclick', () => {\n      if(this.scene.children[1].visible) this.props.clickOnImage();\n    })\n  }\n\n  init() {\n    let { width, height } = this.props;\n    this.scene = new THREE.Scene();\n    let vFOV = 75;\n    let aspect = width / height;\n    let near = 0.01;\n    let far = 1000;\n\n    this.camera = new THREE.PerspectiveCamera(vFOV, aspect, near, far);\n\n    this.renderer = new THREE.WebGLRenderer({ preserveDrawingBuffer: true,alpha: true });\n    this.renderer.setClearColor(0xffffff, 0);\n    this.renderer.autoClear = false;\n    this.renderer.setSize(width, height);\n    this.renderer.domElement.id = \"threeCanvas\";\n    this.mount.appendChild(this.renderer.domElement);\n\n    this.addPoints();\n    this.addBlankHighlightPoints();\n    this.setupCamera();\n    this.animate();\n    this.handleMouse();\n    this.changeEmbeddings(this.props.algorithm_choice);\n  }\n\n  animate() {\n    requestAnimationFrame(this.animate);\n    TWEEN.update();\n    this.renderer.clear()\n    // 1-Pass :: Render filtered images (grey semi-transparent images that create a shadow behind)\n    if(parseInt(this.props.greyRenderTypeSelected)===0){\n      this.updatePass2Shader(1)\n      this.renderer.render(this.scene, this.camera);\n    }\n    // 2-Pass - Render all images\n    this.updatePass2Shader(2)\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  componentDidMount() {\n    this.init();\n  }\n\n  componentDidUpdate(prevProps) {\n    let { width, height } = this.props;\n    if (width !== prevProps.width || height !== prevProps.height) {\n      this.handleResize(width, height);\n    }\n    \n    if (prevProps.algorithm_choice !== this.props.algorithm_choice) {\n      this.changeEmbeddings(\n        //prevProps.algorithm_choice,\n        this.props.algorithm_choice,\n      );\n    }\n    \n    if (this.props.scaleMin !== prevProps.scaleMin || this.props.scaleMax !== prevProps.scaleMax){\n      this.handleResize(width, height);\n    }\n  }\n\n  componentWillUnmount() {\n    this.mount.removeChild(this.renderer.domElement);\n  }\n\n  render() {\n    let { width, height } = this.props;\n    const tileProgress = this.state.tilesLoaded;\n    const allTiles = this.props.settings.sprite_number;\n    return (\n      <><div>\n        {tileProgress < 1 ? <div className=\"loading\"><CircularProgress color=\"inherit\"/><div>loading tiles...</div></div> : \n        tileProgress < allTiles-1 ? <div className=\"loading-small\"><CircularProgress color=\"inherit\"/><div>loading...</div></div> : \n        ''\n      }\n      </div><div\n          style={{ width: width, height: height, overflow: 'hidden' }}\n          ref={mount => {\n            this.mount = mount\n          } } /></>\n    ) \n  }\n}\n\nexport default React.memo(Projection)\n\n\n","import React, { Component } from 'react'\nimport PreviewPane from './PreviewPane'\nimport SliderPane from './SliderPane'\nimport FilterPane from './FilterPane'\nimport InfoPane from './InfoPane'\nimport ViewPane from './ViewPane'\nimport MappingsPane from './MappingsPane'\nimport Export from './Export'\nimport { ProSidebar, Menu, MenuItem, SubMenu } from 'react-pro-sidebar';\nimport './scss/Menu.scss';\nimport Projection from './Projection'\nimport * as _ from 'lodash'\nimport { CircularProgress } from \"@material-ui/core\";\nimport { FaDatabase, FaSlidersH, FaSearch, FaCloudDownloadAlt, FaAngleDoubleLeft, FaAngleDoubleRight, FaRegImage, FaInfo, FaQuestion, FaEye } from \"react-icons/fa\";\n\nclass Layout extends Component {\n  constructor(props) {\n    super(props)\n    let total = this.props.settings[\"total\"]\n    this.state = {\n      ww: null,\n      wh: null,\n      hover_index: 0,\n      previewPane_height: null,\n      controlPane_height: null,\n      filterPane_height: null,\n      algorithm_choice: null,\n      allFilter: {},\n      currentProjection: new Float32Array(total).fill(0),\n      currentFilter: new Float32Array(total).fill(0),\n      currentSearch: new Float32Array(total).fill(0),\n      scaleMin: 14,\n      scaleMax: 70,\n      filterGrey: true,\n      clusterTypeSelected:'-',\n      greyRenderTypeSelected:0,\n      dimensions: {},\n      collapsedControl: false,\n      collapsedObject: false\n    }\n    this.previewPane_ctx = null;\n    this.setSize = _.debounce(this.setSize.bind(this), 200);\n    this.setPreviewPaneCanvas = this.setPreviewPaneCanvas.bind(this);\n    this.setPreviewImage = this.setPreviewImage.bind(this);\n    this.selectAlgorithm = this.selectAlgorithm.bind(this);\n    this.selectDataset = this.selectDataset.bind(this);\n    this.toggleControl = this.toggleControl.bind(this);\n    this.refProjection = React.createRef();\n  }\n\n  componentDidMount() {\n    this.setDefaults();\n    this.selectAlgorithm(this.props.algorithm_name);\n    this.setSize();\n    window.addEventListener('resize', this.setSize);\n  }\n\n  setDefaults(){\n    if (this.props.settings[\"total\"] < 20000) {\n      this.setState( { scaleMin: 15, filterGrey: true, greyRenderTypeSelected: 0 } )\n    } else {\n      this.setState( { scaleMin: 5, filterGrey: false, greyRenderTypeSelected: 1 } )\n    }\n  }\n\n  setRenderer(renderer){\n    this.setState( { renderer: renderer});\n  }\n\n  handleChangeScale(e,val) {\n    this.setState({ scaleMin: val})\n  }\n\n  handleChangeZoom(e,val) {\n    this.setState({ scaleMax: val})\n  }\n\n  handleChangeCluster(e) {\n    let value = e.target.value;\n    this.setState({ clusterTypeSelected: parseInt(value)})\n    console.log(e.target)\n    try{\n      this.refProjection.current.updateClusterColors(value)\n    } catch(error) {console.log(\"error updateClusterColors\")}\n  }\n\n  handleChangeGrey(value) {\n    this.setState({ greyRenderTypeSelected: value})\n  }\n\n  calculateProjection=(newArr,type, update)=>{\n    let A, B, arr;\n    if(type===\"filter\"){\n      this.setState({currentFilter: newArr})\n      A = newArr;\n      B = this.state.currentSearch;\n    }\n    if(type===\"search\"){\n      this.setState({currentSearch: newArr});\n      A = this.state.currentFilter;\n      B = newArr;\n    }\n    if(update){\n      arr = A.map((x, idx) => x + B[idx]);\n      this.setState({currentProjection: arr});\n    } else {\n      arr = newArr;\n    }\n    try{\n      this.refProjection.current.updateProjection(arr);\n    } catch(error) {}\n    }\n\n  selectAlgorithm(v) {\n    let i = this.props.algorithm_options.indexOf(v);\n    if(i<0) i = 0;\n    this.setState({ algorithm_choice: i });\n    // Save algorithm in URL parameters\n    this.props.addToUrl('projection',this.props.algorithm_options[i]);\n  }\n\n  selectDataset(p) {\n    this.props.changeDataset(p);\n  }\n\n  setSize() {\n    this.setState({ ww: window.innerWidth, wh: window.innerHeight });\n    let previewPane_height = this.previewPane_mount.offsetHeight;\n    this.setState({ previewPane_height: previewPane_height });\n    if (this.previewPane_ctx) this.previewPane_ctx.imageSmoothingEnabled = false;\n    if ( window.innerWidth < 900) {\n      this.setState({ collapsedControl: true, collapsedObject: true })\n    } else {\n      this.setState({ collapsedControl: false, collapsedObject: false })\n\n    }\n  }\n\n  setPreviewPaneCanvas(canvas) {\n    let ctx = canvas.getContext('2d');\n    ctx.imageSmoothingEnabled = false;\n    this.previewPane_ctx = ctx;\n    console.log(ctx);\n  }\n\n  setPreviewImage() {\n      return (\n      <img\n      src={ this.props.settings.url_prefix + this.props.metadata[this.state.hover_index].filename }\n      alt=\"preview\"\n      style={{\n        verticalAlign: \"middle\",\n      }}\n      />)\n  }\n\n\n  setHoverIndex(hover_index) {\n    if (hover_index){\n      this.setState({ hover_index: hover_index });\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.setSize);\n  }\n\n  clickOnImage(){\n    console.log(\"open image\",this.state.hover_index);\n    try{\n      let url = this.props.metadata[this.state.hover_index].link_URL\n      window.open(url, '_blank', 'noopener,noreferrer');\n    }catch(err){}\n  }\n\n  toggleControl = () => {\n    this.setState({ collapsedControl: !this.state.collapsedControl \n  })}\n  \n  toggleObject = () => {\n    this.setState({ collapsedObject: !this.state.collapsedObject \n  })}\n\n\n  render() {\n    let {\n      embeddings_data,\n      mappings,\n      algorithm_options,\n      dataset_options,\n      metadata,\n      settings,\n      barData\n    } = this.props;\n\n    let {\n      ww,\n      wh,\n      hover_index,\n      algorithm_choice,\n      currentProjection,\n      allFilter,\n      greyRenderTypeSelected,\n      clusterTypeSelected,\n      collapsedControl,\n      collapsedObject\n    } = this.state;\n\n    let previewPane_ctx = this.previewPane_ctx;\n    \n    let line_height = 1.5;\n\n    let previewPane_style = {\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      // width: 320,\n      height: 'auto',\n      maxHeight: '100vh',\n      overflow: 'auto',\n      background: '#222',\n      zIndex: 8\n    };\n    let controlMenu_style = {\n      position: 'absolute',\n      right: 0,\n      top: 0,\n      // width: 300,\n      // left:ww-350,\n      height: 'auto',\n      maxHeight: '100vh',\n      overflow: 'auto',\n      background: '#222',\n      zIndex: 8\n    };\n\n    let main_style = {\n      position: 'relative',\n      background: '#111',\n      overflow: 'hidden',\n      width: ww, \n      height: wh\n    };\n\n    let previewPane_image_size = '320px';\n    let font_size = 16;\n\n    let grem = font_size * line_height;\n\n    let general_style = {\n      fontSize: font_size,\n      lineHeight: line_height,\n    };\n\n    let displayNumb = 0;\n    for(let i=0;i<settings.total;i++){\n      if(currentProjection[i]===0){\n        displayNumb++;\n      }\n    }\n\n\n    return ww !== null ? (\n      <div style={general_style}>\n        <div\n          style={controlMenu_style}\n          ref={controlMenu_mount => {\n            this.controlMenu_mount = controlMenu_mount\n          }}\n        >\n          <div>\n          <ProSidebar collapsed={collapsedControl}>\n            <Menu iconShape='square'>\n            <MenuItem>\n            <h3></h3>\n            <a className=\"collapseCon\" onClick={this.toggleControl}>{collapsedControl ? < FaAngleDoubleLeft />  : < FaAngleDoubleRight /> }</a>\n            </MenuItem>\n\n              <SubMenu defaultOpen\n              title={collapsedControl ? null : \"Data & Projections\"}  \n              icon={collapsedControl ? < FaDatabase />  : null }\n              >\n              <MenuItem>\n              <MappingsPane\n                grem={grem}\n                algorithm_options={algorithm_options}\n                algorithm_choice={algorithm_choice}\n                selectAlgorithm={this.selectAlgorithm}\n                dataset_options={dataset_options}\n                selectDataset={this.selectDataset}\n                selectedDataset={this.props.selectedDataset}\n                datasetInfo={settings[\"datasetInfo\"]}\n              />\n              </MenuItem>\n              </SubMenu>\n              <SubMenu defaultOpen\n              title={collapsedControl ? null : \"Dimension Filters\"}  \n              icon={collapsedControl ? <FaSlidersH />  : null }\n              >\n\n\n                <MenuItem>\n                <SliderPane\n                grem={grem}\n                metadata={metadata}\n                hover_index={hover_index}\n                settings={settings}\n                barData={barData}\n                calculateProjection={this.calculateProjection}\n                currentProjection={currentProjection}\n                allFilter={allFilter}\n                />\n                </MenuItem>\n                </SubMenu>\n\n                <SubMenu\n                title={collapsedControl ? null : \"Advanced Filters\"}  \n                icon={collapsedControl ? < FaSearch />  : null }\n                >\n\n                <MenuItem>\n                  <FilterPane\n                    grem={grem}\n                    calculateProjection={this.calculateProjection}\n                    hover_index={hover_index}\n                    settings={settings}\n                    metadata={metadata}\n                    currentProjection={currentProjection}\n                    allFilter={allFilter}\n                  />\n                </MenuItem>\n              </SubMenu>\n              <SubMenu\n                title={collapsedControl ? null : \"Export Filtered Data\"}  \n                icon={collapsedControl ? <FaCloudDownloadAlt />  : null }\n                >\n\n              <MenuItem>\n                <Export\n                metadata = {metadata}\n                currentProjection = {currentProjection}\n                />\n              </MenuItem>\n            </SubMenu>\n            </Menu>\n          </ProSidebar>\n          </div>\n        </div>    \n\n        <div\n          style={previewPane_style}\n          ref={previewPane_mount => {\n            this.previewPane_mount = previewPane_mount\n          }}\n        >\n\n        <div>\n          <ProSidebar collapsed={collapsedObject}>\n            <Menu iconShape='square'>   \n            <MenuItem>\n            {collapsedObject ? <h3></h3> : <h3>Collection Space Navigator</h3> }\n            <a className='collapseObj' onClick={this.toggleObject}>{collapsedObject ? < FaAngleDoubleRight />  : < FaAngleDoubleLeft /> }</a>\n            </MenuItem>\n              <SubMenu defaultOpen\n                title={collapsedObject ? null : \"Object Preview\"}  \n                icon={collapsedObject ? <FaRegImage />  : null }\n                >  \n                <PreviewPane\n                  previewPane_image_size={previewPane_image_size}\n                  setPreviewPaneCanvas={this.setPreviewPaneCanvas}\n                  setPreviewImage={this.setPreviewImage}\n                  hover_index={hover_index}\n                />\n              </SubMenu>\n              <SubMenu defaultOpen\n                title={collapsedObject ? null : \"Object Info\"}  \n                icon={collapsedObject ? <FaInfo />  : null }\n                >  \n                <MenuItem>\n                <InfoPane\n                  hover_index={hover_index}\n                  metadata={metadata}\n                  infos={settings.info}\n                />\n                </MenuItem>\n              </SubMenu>\n\n              <SubMenu\n                title={collapsedObject ? null : \"Object Appearance\"}  \n                icon={collapsedObject ? <FaEye />  : null }\n                > \n                <MenuItem>\n                <ViewPane\n                  clusters={settings.clusters}\n                  scaleMin={this.state.scaleMin}\n                  scaleMax={this.state.scaleMax}\n                  filterGrey={this.state.filterGrey}\n                  handleChangeScale = {this.handleChangeScale.bind(this)}\n                  handleChangeZoom = {this.handleChangeZoom.bind(this)}\n                  handleChangeCluster = {this.handleChangeCluster.bind(this)}\n                  handleChangeGrey = {this.handleChangeGrey.bind(this)}\n                  total = {settings.total}\n                />\n                </MenuItem>\n                <MenuItem>\n                <div className='info'>showing {displayNumb} / {settings.total}</div>\n              </MenuItem>\n              </SubMenu>\n\n            <SubMenu\n              title={collapsedObject ? null : 'About'}  \n              icon={collapsedObject ? <FaQuestion />  : null }\n              >         \n              <div className='about'>\n                The Collection Space Navigator (CSN) is an <strong>interactive visualization interface for multidimensional datasets</strong>.\n                It functions as an explorative visualization tool for researching collections and their multidimensional representations. \n                We designed this tool to better understand multidimensional data, its methods, and semantic qualities through spatial navigation and filtering. \n                CSN can be used with any image collection and can be customized for specific research needs. <a href=\"https://github.com/Collection-Space-Navigator/CSN\" target=\"_blank\" rel=\"noreferrer\" ><strong>[more on GitHub...]</strong></a>\n              </div>\n              </SubMenu>\n            </Menu>\n          </ProSidebar>\n          </div>\n        </div>\n        <div style={main_style}>\n          <Projection\n            ref={this.refProjection}\n            width={main_style.width}\n            height={main_style.height}\n            embeddings_data={embeddings_data}\n            mappings={mappings}\n            metadata={metadata}\n            previewPane_ctx={previewPane_ctx}\n            previewPane_image_size={previewPane_image_size}\n            setHoverIndex={this.setHoverIndex.bind(this)}\n            algorithm_choice={algorithm_choice}\n            datasetDir={this.props.datasetDir}\n            clusterTypeSelected={clusterTypeSelected}\n            greyRenderTypeSelected={greyRenderTypeSelected}\n            settings={settings}\n            initPath={this.props.initPath}\n            scaleMin={this.state.scaleMin}\n            scaleMax={this.state.scaleMax}\n            currentProjection={currentProjection}\n            clickOnImage={this.clickOnImage.bind(this)}\n            // tiles={this.tiles}\n          />\n        </div>\n      </div>\n      \n    ) : (\n      <div className=\"loading\"><CircularProgress color=\"inherit\"/><div>loading layout...</div></div>\n    )\n  }\n}\n\nexport default Layout\n\n\n\n","import React, { Component } from 'react'\nimport {useParams, useNavigate} from \"react-router-dom\";\nimport Layout from './Layout'\nimport * as _ from 'lodash'\nimport * as d3 from 'd3'\nimport color from 'color'\n// import * as THREE from 'three'\nimport { CircularProgress } from \"@material-ui/core\";\n\n\nfunction withRouter(Component) {\n  return props => <Component {...props} params={useParams()} navigate={useNavigate()} />;\n}\n\nclass Data extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      // tilesLoaded: 0,\n      algorithm_options: null,\n      dataset_options: null,\n      dataset_dirs: null,\n      embeddings_data: null,\n      mappings: null,\n      metadata:null,\n      defaultDataset:null,\n      algorithm_name:0\n    };\n  }\n\n  scaleEmbeddings(embeddings) {\n    let xs = embeddings.map(e => Math.abs(e[0]));\n    let ys = embeddings.map(e => Math.abs(e[1]));\n    let max_x = _.max(xs);\n    let max_y = _.max(ys);\n    let max = Math.max(max_x, max_y);\n    let scale = d3\n      .scaleLinear()\n      .domain([-max, max])\n      .range([-20, 20]);\n    let scaled_embeddings = embeddings.map(e => [scale(e[0]), scale(e[1])]);\n    return scaled_embeddings;\n  }\n  \n  componentDidMount() {\n    // Get parameters from URL and save to settings\n    const queryString = window.location.search;\n    const urlParams = new URLSearchParams(queryString);\n    this.setState({ selectedDataset: urlParams.get('dataset')});\n    if(urlParams.get('projection')!==undefined) this.setState({algorithm_name:urlParams.get('projection')});\n    // Load embeddings\n    this.loadInit('datasets/datasets_config.json')\n  }\n\n  loadConfig(path){\n    this.loadSettings(`datasets/${path}/config.json`);\n    this.loadBarData(`datasets/${path}/barData.json`);\n    this.loadMetadata(`datasets/${path}/metadata.json`);\n  }\n  \n  prepareMappings(ID){\n    let algorithm_options = [];\n    for (let i in this.state.settings.embeddings) {\n      console.log(this.state.settings.embeddings[i].name);\n      algorithm_options[i] = this.state.settings.embeddings[i].name;\n    }\n    this.setState({ algorithm_options: algorithm_options });\n  }\n\n  loadDataset(ID){\n    let mappings = [];\n    const embeddings = this.state.settings.embeddings;\n    for (let i in embeddings) {\n      // console.log(embeddings[i].key);\n      fetch(`${process.env.PUBLIC_URL}/datasets/${this.state.datasetDir}/${embeddings[i].file}`)\n        .then(response => response.json())\n        .then(embeddings_data => {\n          let scaled_embeddings = embeddings_data;\n          // this.scaleEmbeddings(embeddings_data);\n          mappings[i] = scaled_embeddings;\n        }\n        )\n        .then(() => {\n          this.setState({ mappings: mappings, embeddings_data: mappings[0] })\n        })\n  }\n}\n\n  // loadTiles(){ \n  //   const tile_locations = [...Array(this.state.settings.sprite_number)].map(\n  //     (n, i) => `${process.env.PUBLIC_URL}/datasets/${this.state.datasetDir}/tile_${i}.png`\n  //   )\n  //   let loader = new THREE.TextureLoader();\n  //   this.tiles = tile_locations.map(l => {\n  //     let t = loader.load(l,\n  //       function ( texture ) {\n  //         this.setState({ tilesLoaded: this.state.tilesLoaded+1 });\n  //       }.bind(this)\n  //     )\n  //     t.flipY = false\n  //     t.magFilter = THREE.NearestFilter\n  //     return t\n  //   })    \n  // }\n\n\n  addToUrl(paramName,value){\n    const queryString = window.location.search;\n    const urlParams = new URLSearchParams(queryString);\n    urlParams.set(paramName, value);\n    this.props.navigate(\"?\"+urlParams.toString());\n  }\n\n  prepareDatasets(ID){\n    let dataset_options = [];\n    let dataset_dirs = [];\n    for (let i in this.state.settings.embeddings) {\n      console.log(this.state.settings.embeddings[i].name);\n      dataset_options[i] = this.state.settings.embeddings[i].name;\n      dataset_dirs[i] = this.state.settings.embeddings[i].directory;\n    }\n    this.setState({ dataset_options: dataset_options, dataset_dirs: dataset_dirs });\n  }\n\n  changeDataset(choice){\n    this.addToUrl('dataset',choice);\n    let k = this.state.dataset_options.indexOf(choice);\n    let newDataset = this.state.dataset_dirs[k]\n    this.setState({ \n      selectedDataset: choice, \n      datasetDir: newDataset,\n      algorithm_options: null,\n      embeddings_data: null,\n      mappings: null,\n      metadata: null\n    });\n    this.loadConfig(newDataset);\n  }\n\n  loadInit(file){\n    fetch(`${process.env.PUBLIC_URL}/`+file)\n      .then(response => response.json())\n      .then(init =>{\n        let dataset_options = [];\n        let dataset_dirs = [];\n        for (let i in init.data) {\n          console.log(init.data[i].directory);\n          dataset_options[i] = init.data[i].name;\n          dataset_dirs[i] = init.data[i].directory;\n        }\n        this.setState({ dataset_options: dataset_options,dataset_dirs: dataset_dirs});\n        // Select dataset folder from defined in URL parameters\n        if(this.state.selectedDataset===null){\n          this.setState({ selectedDataset: init.data[init.default].name,  datasetDir: init.data[init.default].directory});\n          this.addToUrl('dataset',init.data[init.default].name);\n        }else{\n          let foundInitDataset = false;\n          for (let i in init.data) {\n            if(init.data[i].name===this.state.selectedDataset){\n              this.setState({datasetDir: init.data[i].directory});\n              foundInitDataset = true;\n            } \n          }\n          if(!foundInitDataset) this.setState({ selectedDataset: init.data[init.default].name,  datasetDir: init.data[init.default].directory});\n        }\n      }\n      )\n      .then(()=> \n      this.loadConfig(this.state.datasetDir))\n\n  }\n\n  loadSettings(file){\n    fetch(`${process.env.PUBLIC_URL}/`+file)\n      .then(response => response.json())\n      .then(settings =>{\n        // Convert colors from rgb(255,0,0) to array [1.0,0.0,0.0]\n        try{\n          const floatColorConvertedArr = settings.clusters.clusterColors.map(myColorFunction);\n          function myColorFunction(value) {\n            return [color(value).rgb().array()[0]/255,color(value).rgb().array()[1]/255,color(value).rgb().array()[2]/255];\n          }\n          settings.clusters.clusterColors = floatColorConvertedArr;\n        }catch(error){}\n        // Save settings to \n        this.setState({\n          settings: settings\n        });\n      }\n      )\n      .then(() =>\n      this.prepareMappings(0))\n      .then(()=> \n      this.loadDataset(0))\n      // .then(()=> \n      // this.loadTiles())\n  }\n\n  loadMetadata(file){\n    fetch(`${process.env.PUBLIC_URL}/`+file)\n      .then(response => response.json())\n      .then(metadata =>\n        this.setState({\n          metadata: metadata,\n        })\n      )\n  }\n\n  loadBarData(file){\n    fetch(`${process.env.PUBLIC_URL}/`+file)\n      .then(response => response.json())\n      .then(barData =>\n        this.setState({\n          barData: barData,\n        })\n      )\n  }\n\n\n  render() {\n    return this.state.embeddings_data && this.state.metadata ? (\n\n      <Layout\n        {...this.state}\n        addToUrl={this.addToUrl.bind(this)}\n        algorithm_name={this.state.algorithm_name}\n        algorithm_options={this.state.algorithm_options}\n        dataset_options={this.state.dataset_options}\n        dataset_dirs={this.state.dataset_dirs}\n        changeDataset={this.changeDataset.bind(this)}\n        selectedDataset={this.state.selectedDataset}\n        datasetDir={this.state.datasetDir}\n        // tiles={this.tiles}\n      />\n\n    ) : (\n      <div className=\"loading\" ><CircularProgress color=\"inherit\"/><div>loading datasets... </div></div>\n      \n    )\n  }\n}\n\nexport default withRouter(Data)\n\n","import React from \"react\";\nimport {\n  BrowserRouter, Routes, Route\n} from \"react-router-dom\";\n\n// Area components\nimport './App.css'\nimport WithRouter from './Data'\n\nexport default function App() {\n  \n  return (\n    <BrowserRouter>\n      <Routes>\n        <Route exact path=\"/\" element={<WithRouter/>} />\n        <Route exact path=\"/CSN\" element={<WithRouter/>}/> \n      </Routes>\n    </BrowserRouter>\n  );\n\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}